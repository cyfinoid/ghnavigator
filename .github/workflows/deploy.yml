name: Deploy to GitHub Pages

on:
  release:
    types: [created]

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v6
      
    - name: Create deployment directory
      run: |
        mkdir -p deploy
        
    - name: Copy web files
      run: |
        # Copy HTML files
        cp index.html deploy/
        cp ghcreds.html deploy/
        cp about.html deploy/
        
        # Copy required CSS and JS files
        cp style.css deploy/
        cp app.js deploy/
        
        # Copy documentation
        cp README.md deploy/
        
        # Verify required files
        echo "‚úÖ Verifying deployment files..."
        
        MISSING_FILES=0
        
        for file in index.html ghcreds.html about.html style.css app.js; do
          if [ ! -f deploy/$file ]; then
            echo "‚ùå Error: $file not found"
            MISSING_FILES=1
          else
            echo "‚úì $file"
          fi
        done
        
        if [ $MISSING_FILES -eq 1 ]; then
          echo "‚ùå Deployment failed: missing required files"
          exit 1
        fi
        
        echo ""
        echo "‚úÖ All required files present"
        echo "üì¶ Files to deploy:"
        ls -la deploy/
        
    - name: Setup Pages
      uses: actions/configure-pages@v5
      
    - name: Upload artifact
      uses: actions/upload-pages-artifact@v4
      with:
        path: './deploy'
        
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4
